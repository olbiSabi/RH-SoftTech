<!-- gestion_temps_activite/templates/gestion_temps_activite/includes/confirm_modal.html -->

<div class="modal fade" id="{{ modal_id|default:'confirmModal' }}" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header bg-{{ color|default:'danger' }} text-white">
                <h5 class="modal-title">
                    <i class="fas fa-{{ icon|default:'exclamation-triangle' }}"></i>
                    {{ title|default:'Confirmation' }}
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>{{ message|default:'Êtes-vous sûr de vouloir effectuer cette action ?' }}</p>

                {% if show_details %}
                <div class="alert alert-{{ color|default:'danger' }} alert-details">
                    {{ details }}
                </div>
                {% endif %}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    <i class="fas fa-times"></i> {{ cancel_label|default:'Annuler' }}
                </button>
                <button type="button" class="btn btn-{{ color|default:'danger' }}" id="confirmBtn">
                    <i class="fas fa-check"></i> {{ confirm_label|default:'Confirmer' }}
                </button>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    const modal = document.getElementById('{{ modal_id|default:"confirmModal" }}');
    if (!modal) return;

    const confirmBtn = modal.querySelector('#confirmBtn');
    let confirmCallback = null;

    // Fonction pour ouvrir le modal
    window.showConfirmModal = function(callback, options = {}) {
        confirmCallback = callback;

        if (options.title) {
            modal.querySelector('.modal-title').innerHTML =
                `<i class="fas fa-${options.icon || 'exclamation-triangle'}"></i> ${options.title}`;
        }

        if (options.message) {
            modal.querySelector('.modal-body p').textContent = options.message;
        }

        $(modal).modal('show');
    };

    // Gestion du clic sur confirmer
    confirmBtn.addEventListener('click', function() {
        if (confirmCallback) {
            confirmCallback();
        }
        $(modal).modal('hide');
    });
})();
</script>
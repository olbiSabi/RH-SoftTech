# Generated by Django 5.0.6 on 2025-12-12 00:05

import django.db.models.deletion
import django.utils.timezone
import employee.models
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('absence', '0001_initial'),
        ('auth', '0012_alter_user_first_name_max_length'),
        ('departement', '0001_initial'),
        ('entreprise', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='UserSecurity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('login_attempts', models.IntegerField(default=0)),
                ('last_login_attempt', models.DateTimeField(blank=True, null=True)),
                ('is_locked', models.BooleanField(default=False)),
                ('locked_until', models.DateTimeField(blank=True, null=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='security', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Sécurité utilisateur',
                'verbose_name_plural': 'Sécurités utilisateurs',
                'db_table': 'user_security',
            },
        ),
        migrations.CreateModel(
            name='ZY00',
            fields=[
                ('matricule', models.CharField(editable=False, max_length=8, primary_key=True, serialize=False, unique=True, verbose_name='Matricule')),
                ('nom', models.CharField(max_length=100, verbose_name='Nom')),
                ('prenoms', models.CharField(max_length=200, verbose_name='Prénom(s)')),
                ('username', models.CharField(blank=True, help_text="Nom utilisé pour l'authentification et l'affichage", max_length=100, verbose_name="Nom d'utilisateur")),
                ('prenomuser', models.CharField(blank=True, help_text="Prénom utilisé pour l'authentification et l'affichage", max_length=200, verbose_name='Prénom utilisateur')),
                ('date_naissance', models.DateField(verbose_name='Date de naissance')),
                ('sexe', models.CharField(choices=[('M', 'Masculin'), ('F', 'Féminin')], max_length=1, verbose_name='Sexe')),
                ('ville_naissance', models.CharField(blank=True, max_length=100, verbose_name='Ville de naissance')),
                ('pays_naissance', models.CharField(blank=True, max_length=100, verbose_name='Pays de naissance')),
                ('photo', models.ImageField(blank=True, help_text="Photo de profil de l'employé (formats acceptés: JPG, PNG)", null=True, upload_to=employee.models.employee_photo_path, verbose_name='Photo de profil')),
                ('situation_familiale', models.CharField(blank=True, choices=[('CELIBATAIRE', 'Célibataire'), ('MARIE', 'Marié'), ('DIVORCE', 'Divorcé'), ('VEUVE', 'Veuve'), ('VEUF', 'Veuf'), ('PACSE', 'Pacsé'), ('CONCUBINAGE', 'Concubinage')], max_length=20, verbose_name='Situation familiale')),
                ('type_id', models.CharField(choices=[('CNI', 'CNI'), ('PASSEPORT', 'Passeport'), ('AUTRES', 'Autres')], max_length=20, verbose_name="Type d'identité")),
                ('numero_id', models.CharField(max_length=50, unique=True, verbose_name="Numéro d'identité")),
                ('date_validite_id', models.DateField(verbose_name='Date de validité ID')),
                ('date_expiration_id', models.DateField(verbose_name="Date d'expiration ID")),
                ('type_dossier', models.CharField(choices=[('PRE', 'Pré-embauche'), ('SAL', 'Salarié')], default='PRE', max_length=3, verbose_name='Type de dossier')),
                ('date_validation_embauche', models.DateField(blank=True, null=True, verbose_name='Date de validation embauche')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('etat', models.CharField(choices=[('actif', 'Actif'), ('inactif', 'Inactif')], default='actif', max_length=20)),
                ('date_entree_entreprise', models.DateField(blank=True, help_text="Date de première prise de service dans l'entreprise", null=True, verbose_name="Date d'entrée dans l'entreprise")),
                ('coefficient_temps_travail', models.DecimalField(decimal_places=2, default=1.0, help_text='1.00 = temps plein, 0.50 = mi-temps, etc.', max_digits=3, verbose_name='Coefficient temps travail')),
                ('convention_personnalisee', models.ForeignKey(blank=True, help_text="Convention spécifique (prioritaire sur celle de l'entreprise)", null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employes_personnalises', to='absence.configurationconventionnelle', verbose_name='Convention personnalisée')),
                ('entreprise', models.ForeignKey(blank=True, help_text="Entreprise à laquelle l'employé est rattaché", null=True, on_delete=django.db.models.deletion.PROTECT, related_name='employes', to='entreprise.entreprise', verbose_name='Entreprise')),
                ('user', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='employe', to=settings.AUTH_USER_MODEL, verbose_name='Compte utilisateur')),
            ],
            options={
                'verbose_name': 'Employé',
                'verbose_name_plural': 'Employés',
                'db_table': 'ZY00',
            },
        ),
        migrations.CreateModel(
            name='ZYAD',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('rue', models.CharField(max_length=200, verbose_name='Rue')),
                ('complement', models.CharField(blank=True, max_length=200, null=True, verbose_name="Complément d'adresse")),
                ('ville', models.CharField(max_length=100, verbose_name='Ville')),
                ('pays', models.CharField(max_length=100, verbose_name='Pays')),
                ('code_postal', models.CharField(max_length=10, verbose_name='Code postal')),
                ('type_adresse', models.CharField(choices=[('PRINCIPALE', 'Résidence principale'), ('SECONDAIRE', 'Résidence secondaire')], max_length=20, verbose_name="Type d'adresse")),
                ('date_debut', models.DateField(verbose_name='Date de début')),
                ('date_fin', models.DateField(blank=True, null=True, verbose_name='Date de fin')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='adresses', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Adresse',
                'verbose_name_plural': 'Adresses',
                'db_table': 'ZYAD',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ZYAF',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_debut', models.DateField(verbose_name="Date de début d'affectation")),
                ('date_fin', models.DateField(blank=True, null=True, verbose_name="Date de fin d'affectation")),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='affectations', to='employee.zy00', verbose_name='Employé')),
                ('poste', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='departement.zdpo', verbose_name='Poste')),
            ],
            options={
                'verbose_name': 'Affectation',
                'verbose_name_plural': 'Affectations',
                'db_table': 'ZYAF',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ZYCO',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_contrat', models.CharField(choices=[('CDD', 'CDD'), ('CDI', 'CDI'), ('STAGE', 'Stage'), ('ALTERNANCE', 'Alternance'), ('APPRENTISSAGE', 'Apprentissage'), ('CONTRACTUELLE', 'Contractuelle'), ('VACATAIRE', 'Vacataire')], max_length=20, verbose_name='Type de contrat')),
                ('date_debut', models.DateField(verbose_name='Date de début')),
                ('date_fin', models.DateField(blank=True, null=True, verbose_name='Date de fin')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contrats', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Contrat',
                'verbose_name_plural': 'Contrats',
                'db_table': 'ZYCO',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ZYDO',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_document', models.CharField(choices=[('CV', 'CV'), ('LETTRE_MOTIVATION', 'Lettre de motivation'), ('DIPLOME', 'Diplôme'), ('ATTESTATION_FORMATION', 'Attestation de formation'), ('CERTIFICAT_TRAVAIL', 'Certificat de travail'), ('LETTRE_RECOMMANDATION', 'Lettre de recommandation'), ('CNI', "Carte Nationale d'Identité"), ('PASSEPORT', 'Passeport'), ('ACTE_NAISSANCE', 'Acte de naissance'), ('CERTIFICAT_RESIDENCE', 'Certificat de résidence'), ('RIB', 'RIB'), ('ATTESTATION_SECURITE_SOCIALE', 'Attestation sécurité sociale'), ('CERTIFICAT_MEDICAL', 'Certificat médical'), ('CONTRAT_SIGNE', 'Contrat signé'), ('ATTESTATION_ASSURANCE', "Attestation d'assurance"), ('JUSTIFICATIF_DOMICILE', 'Justificatif de domicile'), ('PHOTO_IDENTITE', "Photo d'identité"), ('AUTRES', 'Autres')], max_length=50, verbose_name='Type de document')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('fichier', models.FileField(upload_to='documents/employes/%Y/%m/', verbose_name='Fichier')),
                ('date_ajout', models.DateTimeField(auto_now_add=True, verbose_name="Date d'ajout")),
                ('date_modification', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('taille_fichier', models.IntegerField(blank=True, null=True, verbose_name='Taille (octets)')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='documents', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Document',
                'verbose_name_plural': 'Documents',
                'db_table': 'ZYDO',
                'ordering': ['-date_ajout'],
            },
        ),
        migrations.CreateModel(
            name='ZYFA',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('personne_charge', models.CharField(choices=[('ENFANT', 'Enfant'), ('CONJOINT', 'Conjoint'), ('PARENT', 'Parent'), ('AUTRE', 'Autre personne à charge')], max_length=20, verbose_name='Personne en charge')),
                ('nom', models.CharField(max_length=100, verbose_name='Nom')),
                ('prenom', models.CharField(max_length=200, verbose_name='Prénom')),
                ('sexe', models.CharField(choices=[('M', 'Masculin'), ('F', 'Féminin')], max_length=1, verbose_name='Sexe')),
                ('date_naissance', models.DateField(verbose_name='Date de naissance')),
                ('date_debut_prise_charge', models.DateField(verbose_name='Date de début de prise en charge')),
                ('date_fin_prise_charge', models.DateField(blank=True, null=True, verbose_name='Date de fin de prise en charge')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='personnes_charge', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Personne à charge',
                'verbose_name_plural': 'Personnes à charge',
                'db_table': 'ZYFA',
                'ordering': ['-date_debut_prise_charge'],
            },
        ),
        migrations.CreateModel(
            name='ZYIB',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('titulaire_compte', models.CharField(help_text='Nom du ou des titulaires du compte', max_length=200, verbose_name='Titulaire du compte')),
                ('nom_banque', models.CharField(max_length=100, verbose_name='Nom de la banque')),
                ('code_banque', models.CharField(help_text='5 chiffres', max_length=5, verbose_name='Code banque')),
                ('code_guichet', models.CharField(help_text='5 chiffres', max_length=5, verbose_name='Code guichet')),
                ('numero_compte', models.CharField(help_text='11 caractères', max_length=11, verbose_name='Numéro de compte')),
                ('cle_rib', models.CharField(help_text='2 chiffres', max_length=2, verbose_name='Clé RIB')),
                ('iban', models.CharField(blank=True, help_text='Numéro IBAN international (max 34 caractères)', max_length=34, null=True, verbose_name='IBAN')),
                ('bic', models.CharField(blank=True, help_text='Code BIC/SWIFT (8 ou 11 caractères)', max_length=11, null=True, verbose_name='BIC/SWIFT')),
                ('type_compte', models.CharField(choices=[('COURANT', 'Compte courant'), ('EPARGNE', 'Compte épargne'), ('JOINT', 'Compte joint')], default='COURANT', max_length=20, verbose_name='Type de compte')),
                ('domiciliation', models.CharField(blank=True, help_text="Adresse complète de l'agence", max_length=200, null=True, verbose_name='Domiciliation bancaire')),
                ('date_ouverture', models.DateField(blank=True, null=True, verbose_name="Date d'ouverture du compte")),
                ('date_ajout', models.DateTimeField(auto_now_add=True, verbose_name="Date d'ajout")),
                ('date_modification', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('actif', models.BooleanField(default=True, verbose_name='Actif')),
                ('remarques', models.TextField(blank=True, null=True, verbose_name='Remarques')),
                ('employe', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='identite_bancaire', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Identité bancaire',
                'verbose_name_plural': 'Identités bancaires',
                'db_table': 'ZYIB',
                'ordering': ['-date_modification'],
            },
        ),
        migrations.CreateModel(
            name='ZYME',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('email', models.EmailField(max_length=254, verbose_name='Email')),
                ('date_debut_validite', models.DateField(verbose_name='Date de début de validité')),
                ('date_fin_validite', models.DateField(blank=True, null=True, verbose_name='Date de fin de validité')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='emails', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Email',
                'verbose_name_plural': 'Emails',
                'db_table': 'ZYME',
                'ordering': ['-date_debut_validite'],
            },
        ),
        migrations.CreateModel(
            name='ZYNP',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100, verbose_name='Nom')),
                ('prenoms', models.CharField(max_length=200, verbose_name='Prénom(s)')),
                ('date_debut_validite', models.DateField(verbose_name='Date de début de validité')),
                ('date_fin_validite', models.DateField(blank=True, null=True, verbose_name='Date de fin de validité')),
                ('actif', models.BooleanField(default=True, verbose_name='Actif')),
                ('date_creation', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='historique_noms_prenoms', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Historique nom/prénom',
                'verbose_name_plural': 'Historiques noms/prénoms',
                'db_table': 'ZYNP',
                'ordering': ['-date_debut_validite', '-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='ZYPP',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100, verbose_name='Nom')),
                ('prenom', models.CharField(max_length=200, verbose_name='Prénom')),
                ('lien_parente', models.CharField(choices=[('CONJOINT', 'Conjoint(e)'), ('PARENT', 'Parent'), ('ENFANT', 'Enfant'), ('FRERE_SOEUR', 'Frère/Sœur'), ('AMI', 'Ami(e)'), ('COLLEGUE', 'Collègue'), ('VOISIN', 'Voisin(e)'), ('AUTRE', 'Autre')], max_length=20, verbose_name='Lien de parenté')),
                ('telephone_principal', models.CharField(max_length=20, verbose_name='Téléphone principal')),
                ('telephone_secondaire', models.CharField(blank=True, max_length=20, null=True, verbose_name='Téléphone secondaire')),
                ('email', models.EmailField(blank=True, max_length=254, null=True, verbose_name='Email')),
                ('adresse', models.TextField(blank=True, null=True, verbose_name='Adresse complète')),
                ('ordre_priorite', models.IntegerField(choices=[(1, 'Contact principal'), (2, 'Contact secondaire'), (3, 'Contact tertiaire')], default=1, verbose_name='Ordre de priorité')),
                ('remarques', models.TextField(blank=True, null=True, verbose_name='Remarques')),
                ('date_debut_validite', models.DateField(default=django.utils.timezone.now, verbose_name='Date de début de validité')),
                ('date_fin_validite', models.DateField(blank=True, null=True, verbose_name='Date de fin de validité')),
                ('actif', models.BooleanField(default=True, verbose_name='Actif')),
                ('date_creation', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('date_modification', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='personnes_prevenir', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Personne à prévenir',
                'verbose_name_plural': 'Personnes à prévenir',
                'db_table': 'ZYPP',
                'ordering': ['ordre_priorite', '-date_debut_validite'],
            },
        ),
        migrations.CreateModel(
            name='ZYRO',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('CODE', models.CharField(max_length=20, unique=True, verbose_name='Code du rôle')),
                ('LIBELLE', models.CharField(max_length=100, verbose_name='Libellé du rôle')),
                ('DESCRIPTION', models.TextField(blank=True, null=True, verbose_name='Description du rôle')),
                ('PERMISSIONS_CUSTOM', models.JSONField(blank=True, default=dict, help_text="Permissions métier non gérées par Django. Ex: {'can_validate_rh': True}", verbose_name='Permissions personnalisées')),
                ('actif', models.BooleanField(default=True, verbose_name='Rôle actif')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('django_group', models.OneToOneField(blank=True, help_text='Groupe Django pour les permissions natives', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='role_zyro', to='auth.group', verbose_name='Groupe Django associé')),
            ],
            options={
                'verbose_name': 'Rôle',
                'verbose_name_plural': 'Rôles',
                'db_table': 'ZYRO',
                'ordering': ['CODE'],
                'permissions': [('manage_roles', 'Peut gérer les rôles'), ('assign_roles', 'Peut attribuer des rôles'), ('view_all_roles', 'Peut voir tous les rôles')],
            },
        ),
        migrations.CreateModel(
            name='ZYRE',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_debut', models.DateField(verbose_name='Date de début')),
                ('date_fin', models.DateField(blank=True, null=True, verbose_name='Date de fin')),
                ('actif', models.BooleanField(default=True, verbose_name='Attribution active')),
                ('commentaire', models.TextField(blank=True, null=True, verbose_name='Commentaire')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='roles_crees', to='employee.zy00', verbose_name='Créé par')),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='roles_attribues', to='employee.zy00', verbose_name='Employé')),
                ('role', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attributions', to='employee.zyro', verbose_name='Rôle')),
            ],
            options={
                'verbose_name': 'Attribution de rôle',
                'verbose_name_plural': 'Attributions de rôles',
                'db_table': 'ZYRE',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ZYTE',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(max_length=20, verbose_name='Numéro de téléphone')),
                ('date_debut_validite', models.DateField(verbose_name='Date de début de validité')),
                ('date_fin_validite', models.DateField(blank=True, null=True, verbose_name='Date de fin de validité')),
                ('actif', models.BooleanField(default=True)),
                ('employe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='telephones', to='employee.zy00', verbose_name='Employé')),
            ],
            options={
                'verbose_name': 'Téléphone',
                'verbose_name_plural': 'Téléphones',
                'db_table': 'ZYTE',
                'ordering': ['-date_debut_validite'],
            },
        ),
        migrations.AddIndex(
            model_name='zy00',
            index=models.Index(fields=['entreprise', 'etat'], name='ZY00_entrepr_c128f7_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='zyre',
            unique_together={('employe', 'role', 'actif')},
        ),
    ]
